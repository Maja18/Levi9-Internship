<?xml version="1.0" encoding="UTF-8"?>
<databaseChangeLog
        xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xmlns:ext="http://www.liquibase.org/xml/ns/dbchangelog-ext"
        xmlns:pro="http://www.liquibase.org/xml/ns/pro"
        xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog
		http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-4.9.xsd
		http://www.liquibase.org/xml/ns/dbchangelog-ext http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-ext.xsd
		http://www.liquibase.org/xml/ns/pro http://www.liquibase.org/xml/ns/pro/liquibase-pro-4.9.xsd">
    <changeSet id="202010211812" author="Stefan Ugarkovic">
        <createTable tableName="person">
            <column name="person_id" type="bigint">
                <constraints primaryKey="true" primaryKeyName="person_id_pk" />
            </column>
            <column name="name" type="varchar(250)"/>
            <column name="surname" type="varchar(250)"/>
            <column name="email" type="varchar(250)"/>
            <column name="username" type="varchar(250)"/>
            <column name="password" type="varchar(250)"/>
            <column name="role" type="varchar(250)"/>
        </createTable>
        <createTable tableName="groupNW">
            <column name="group_id" type="bigint">
                <constraints primaryKey="true" primaryKeyName="group_id_pk" />
            </column>
            <column name="name" type="varchar(250)"/>
            <column name="description" type="varchar(250)"/>
            <column name="is_public" type="boolean"/>
            <column name="creator_id" type="bigint"/>
        </createTable>
        <createTable tableName="post">
            <column name="post_id" type="bigint">
                <constraints primaryKey="true" primaryKeyName="post_id_pk" />
            </column>
            <column name="content" type="TEXT"/>
            <column name="image_url" type="varchar(250)"/>
            <column name="video_url" type="varchar(250)"/>
            <column name="creation_data" type="DATETIME"/>
            <column name="is_public" type="boolean"/>
            <column name="is_over" type="boolean"/>
            <column name="creator_id" type="bigint"/>
        </createTable>
        <createTable tableName="comment">
            <column name="comment_id" type="bigint">
                <constraints primaryKey="true" primaryKeyName="comment_id_pk" />
            </column>
            <column name="content" type="varchar(250)"/>
            <column name="description" type="varchar(250)"/>
            <column name="post_id" type="bigint"/>
            <column name="parent_id" type="bigint"/>
            <column name="creator_id" type="bigint"/>
        </createTable>
        <createTable tableName="event">
            <column name="event_id" type="bigint">
                <constraints primaryKey="true" primaryKeyName="event_id_pk" />
            </column>
            <column name="name" type="varchar(250)"/>
            <column name="start_event" type="DATETIME"/>
            <column name="end_event" type="DATETIME"/>
            <column name="X" type="FLOAT"/>
            <column name="Y" type="FLOAT"/>
            <column name="group_id" type="bigint"/>
            <column name="creator_id" type="bigint"/>
            <column name="is_over" type="boolean"/>
        </createTable>
        <createTable tableName="group_request">
            <column name="GroupRequestId" type="bigint">
                <constraints primaryKey="true" primaryKeyName="group_request_id_pk" />
            </column>
            <column name="content" type="varchar(250)"/>
            <column name="status" type="varchar(250)"/>
            <column name="creator_id" type="bigint"/>
            <column name="group_id" type="bigint"/>
        </createTable>
        <createTable tableName="friends">
            <column name="person_id" type="bigint"/>
            <column name="friend_id" type="bigint"/>
        </createTable>
        <createTable tableName="group_persons">
            <column name="group_id" type="bigint"/>
            <column name="person_id" type="bigint"/>
        </createTable>
        <createTable tableName="event_persons">
            <column name="event_id" type="bigint"/>
            <column name="person_id" type="bigint"/>
        </createTable>
        <createTable tableName="block_persons">
            <column name="post_id" type="bigint"/>
            <column name="person_id" type="bigint"/>
        </createTable>
        <createTable tableName="authority">
            <column name="authority_id" type="bigint">
                <constraints primaryKey="true" primaryKeyName="authority_id_pk" />
            </column>
            <column name="name" type="varchar(250)"/>
        </createTable>
        <createTable tableName="user_authority">
            <column name="authority_id" type="bigint"/>
            <column name="person_id" type="bigint"/>
        </createTable>
        <addAutoIncrement tableName="person" columnName="person_id" columnDataType="bigint" startWith="1" incrementBy="1" />
        <addAutoIncrement tableName="groupNW" columnName="group_id" columnDataType="bigint" startWith="1" incrementBy="1" />
        <addAutoIncrement tableName="post" columnName="post_id" columnDataType="bigint" startWith="1" incrementBy="1" />
        <addAutoIncrement tableName="comment" columnName="comment_id" columnDataType="bigint" startWith="1" incrementBy="1" />
        <addAutoIncrement tableName="event" columnName="event_id" columnDataType="bigint" startWith="1" incrementBy="1" />
        <addAutoIncrement tableName="group_request" columnName="GroupRequestId" columnDataType="bigint" startWith="1" incrementBy="1" />
        <addForeignKeyConstraint baseTableName="groupNW" baseColumnNames="creator_id" constraintName="group_person_id_fk" referencedTableName="person" referencedColumnNames="person_id" />
        <addForeignKeyConstraint baseTableName="post" baseColumnNames="creator_id" constraintName="post_person_id_fk" referencedTableName="person" referencedColumnNames="person_id" />
        <addForeignKeyConstraint baseTableName="comment" baseColumnNames="post_id" constraintName="comment_post_id_fk" referencedTableName="post" referencedColumnNames="post_id" />
        <addForeignKeyConstraint baseTableName="comment" baseColumnNames="creator_id" constraintName="comment_person_id_fk" referencedTableName="person" referencedColumnNames="person_id" />
        <addForeignKeyConstraint baseTableName="event" baseColumnNames="group_id" constraintName="event_group_id_fk" referencedTableName="groupNW" referencedColumnNames="group_id" />
        <addForeignKeyConstraint baseTableName="event" baseColumnNames="creator_id" constraintName="event_person_id_fk" referencedTableName="person" referencedColumnNames="person_id" />
        <addForeignKeyConstraint baseTableName="group_request" baseColumnNames="group_id" constraintName="group_request_group_id_fk" referencedTableName="groupNW" referencedColumnNames="group_id" />
        <addForeignKeyConstraint baseTableName="group_request" baseColumnNames="creator_id" constraintName="group_request_person_id_fk" referencedTableName="person" referencedColumnNames="person_id" />
        <addForeignKeyConstraint baseTableName="friends" baseColumnNames="person_id" constraintName="friends_person_id_fk" referencedTableName="person" referencedColumnNames="person_id" />
        <addForeignKeyConstraint baseTableName="friends" baseColumnNames="friend_id" constraintName="friends_friend_id_fk" referencedTableName="person" referencedColumnNames="person_id" />
        <addForeignKeyConstraint baseTableName="group_persons" baseColumnNames="group_id" constraintName="group_persons_group_id_fk" referencedTableName="groupNW" referencedColumnNames="group_id" />
        <addForeignKeyConstraint baseTableName="friends" baseColumnNames="person_id" constraintName="group_persons_person_id_fk" referencedTableName="person" referencedColumnNames="person_id" />
        <addForeignKeyConstraint baseTableName="event_persons" baseColumnNames="event_id" constraintName="event_persons_event_id_fk" referencedTableName="event" referencedColumnNames="event_id" />
        <addForeignKeyConstraint baseTableName="event_persons" baseColumnNames="person_id" constraintName="event_persons_person_id_fk" referencedTableName="person" referencedColumnNames="person_id" />
        <addForeignKeyConstraint baseTableName="block_persons" baseColumnNames="post_id" constraintName="block_persons_post_id_fk" referencedTableName="post" referencedColumnNames="post_id" />
        <addForeignKeyConstraint baseTableName="block_persons" baseColumnNames="person_id" constraintName="block_persons_person_id_fk" referencedTableName="person" referencedColumnNames="person_id" />
        <addForeignKeyConstraint baseTableName="user_authority" baseColumnNames="authority_id" constraintName="authority_persons_authority_id_fk" referencedTableName="authority" referencedColumnNames="authority_id" />
        <addForeignKeyConstraint baseTableName="user_authority" baseColumnNames="person_id" constraintName="authority_persons_person_id_fk" referencedTableName="person" referencedColumnNames="person_id" />
    </changeSet>
</databaseChangeLog>